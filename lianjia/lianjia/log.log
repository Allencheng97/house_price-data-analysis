2020-03-20 21:36:44 [scrapy.utils.log] INFO: Scrapy 1.6.0 started (bot: lianjia)
2020-03-20 21:36:44 [scrapy.utils.log] INFO: Versions: lxml 3.7.3.0, libxml2 2.9.4, cssselect 1.0.3, parsel 1.5.1, w3lib 1.20.0, Twisted 19.2.1, Python 3.6.7 (v3.6.7:6ec5cf24b7, Oct 20 2018, 13:35:33) [MSC v.1900 64 bit (AMD64)], pyOpenSSL 18.0.0 (OpenSSL 1.1.1d  10 Sep 2019), cryptography 2.8, Platform Windows-10-10.0.18362-SP0
2020-03-20 21:36:44 [scrapy.crawler] INFO: Overridden settings: {'BOT_NAME': 'lianjia', 'CONCURRENT_ITEMS': 32, 'CONCURRENT_REQUESTS': 32, 'COOKIES_ENABLED': False, 'DOWNLOAD_DELAY': 1, 'HTTPCACHE_ENABLED': True, 'LOG_FILE': './log.log', 'NEWSPIDER_MODULE': 'lianjia.spiders', 'SPIDER_MODULES': ['lianjia.spiders'], 'TELNETCONSOLE_ENABLED': False}
2020-03-20 21:36:44 [scrapy.middleware] INFO: Enabled extensions:
['scrapy.extensions.corestats.CoreStats', 'scrapy.extensions.logstats.LogStats']
2020-03-20 21:36:44 [scrapy.middleware] INFO: Enabled downloader middlewares:
['scrapy.downloadermiddlewares.httpauth.HttpAuthMiddleware',
 'scrapy.downloadermiddlewares.downloadtimeout.DownloadTimeoutMiddleware',
 'scrapy.downloadermiddlewares.defaultheaders.DefaultHeadersMiddleware',
 'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware',
 'scrapy.downloadermiddlewares.retry.RetryMiddleware',
 'scrapy.downloadermiddlewares.redirect.MetaRefreshMiddleware',
 'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware',
 'scrapy.downloadermiddlewares.redirect.RedirectMiddleware',
 'scrapy.downloadermiddlewares.httpproxy.HttpProxyMiddleware',
 'scrapy.downloadermiddlewares.stats.DownloaderStats',
 'scrapy.downloadermiddlewares.httpcache.HttpCacheMiddleware']
2020-03-20 21:36:44 [scrapy.middleware] INFO: Enabled spider middlewares:
['scrapy.spidermiddlewares.httperror.HttpErrorMiddleware',
 'scrapy.spidermiddlewares.offsite.OffsiteMiddleware',
 'scrapy.spidermiddlewares.referer.RefererMiddleware',
 'scrapy.spidermiddlewares.urllength.UrlLengthMiddleware',
 'scrapy.spidermiddlewares.depth.DepthMiddleware']
2020-03-20 21:36:44 [matplotlib] DEBUG: CACHEDIR=C:\Users\Allen\.matplotlib
2020-03-20 21:36:44 [matplotlib.font_manager] DEBUG: Using fontManager instance from C:\Users\Allen\.matplotlib\fontlist-v310.json
2020-03-20 21:36:44 [scrapy.middleware] INFO: Enabled item pipelines:
['lianjia.pipelines.LianjiaPipeline']
2020-03-20 21:36:44 [scrapy.core.engine] INFO: Spider opened
2020-03-20 21:36:44 [scrapy.extensions.logstats] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2020-03-20 21:36:44 [scrapy.extensions.httpcache] DEBUG: Using filesystem cache storage in C:\Users\Allen\Desktop\test\lianjia\.scrapy\httpcache
2020-03-20 21:36:44 [scrapy.downloadermiddlewares.redirect] DEBUG: Redirecting (301) to <GET https://weihai.lianjia.com/ershoufang/pg/> from <GET https://weihai.lianjia.com/ershoufang/pg>
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg/> (referer: None) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg13/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg12/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg11/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg10/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg9/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg8/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg7/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg6/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg5/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg4/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg3/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg2/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg1/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg89/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg88/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg87/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg86/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg85/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg84/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg83/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg82/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg81/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg80/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg79/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg78/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:44 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg100/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg13/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg99/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg12/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg11/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg8/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg10/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg9/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg98/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg97/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg96/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg95/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg7/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg94/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg93/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg6/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg3/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg5/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg4/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg1/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg89/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg2/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg82/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg84/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg83/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg88/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg86/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg85/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg87/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg80/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg79/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg81/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg78/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg92/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg91/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg90/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg77/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg76/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg75/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg74/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg73/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg72/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg71/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg70/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg69/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg68/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg67/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg66/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg65/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg64/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg100/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg63/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg62/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg99/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg98/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg97/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg96/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg95/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg94/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg93/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg61/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg60/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg59/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg58/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg57/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg56/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg55/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg92/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg91/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg90/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg77/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg76/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg74/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg73/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg75/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg68/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg67/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg72/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg70/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg69/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg71/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg65/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg66/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg64/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg54/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg53/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg52/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg51/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg50/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg49/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg48/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg47/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg46/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg45/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg44/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg43/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg42/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg41/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg40/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg39/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg38/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg62/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg63/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg37/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg36/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg61/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg60/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg59/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg58/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg57/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg56/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg55/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg35/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg34/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg33/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg32/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg31/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg30/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg29/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg54/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg52/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg50/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg49/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg51/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg53/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg48/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg46/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg47/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg45/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg44/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg43/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg28/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg27/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg26/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg25/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg24/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg23/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg22/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg21/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg20/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg19/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg18/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg17/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg42/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg41/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg40/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg39/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg38/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg16/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg15/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg14/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg37/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg36/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg35/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg33/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg32/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg34/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg31/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg30/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg29/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg28/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg27/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg26/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg23/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg21/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg22/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg25/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg24/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg20/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg18/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg17/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg19/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg16/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg14/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg15/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 34, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:36:46 [scrapy.core.engine] INFO: Closing spider (finished)
2020-03-20 21:36:46 [scrapy.statscollectors] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 35583,
 'downloader/request_count': 102,
 'downloader/request_method_count/GET': 102,
 'downloader/response_bytes': 3165205,
 'downloader/response_count': 102,
 'downloader/response_status_count/200': 101,
 'downloader/response_status_count/301': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2020, 3, 20, 13, 36, 46, 122109),
 'httpcache/hit': 102,
 'log_count/DEBUG': 105,
 'log_count/ERROR': 100,
 'log_count/INFO': 7,
 'request_depth_max': 1,
 'response_received_count': 101,
 'scheduler/dequeued': 102,
 'scheduler/dequeued/memory': 102,
 'scheduler/enqueued': 102,
 'scheduler/enqueued/memory': 102,
 'spider_exceptions/TypeError': 100,
 'start_time': datetime.datetime(2020, 3, 20, 13, 36, 44, 797088)}
2020-03-20 21:36:46 [scrapy.core.engine] INFO: Spider closed (finished)
2020-03-20 21:37:18 [scrapy.utils.log] INFO: Scrapy 1.6.0 started (bot: lianjia)
2020-03-20 21:37:18 [scrapy.utils.log] INFO: Versions: lxml 3.7.3.0, libxml2 2.9.4, cssselect 1.0.3, parsel 1.5.1, w3lib 1.20.0, Twisted 19.2.1, Python 3.6.7 (v3.6.7:6ec5cf24b7, Oct 20 2018, 13:35:33) [MSC v.1900 64 bit (AMD64)], pyOpenSSL 18.0.0 (OpenSSL 1.1.1d  10 Sep 2019), cryptography 2.8, Platform Windows-10-10.0.18362-SP0
2020-03-20 21:37:18 [scrapy.crawler] INFO: Overridden settings: {'BOT_NAME': 'lianjia', 'CONCURRENT_ITEMS': 32, 'CONCURRENT_REQUESTS': 32, 'COOKIES_ENABLED': False, 'DOWNLOAD_DELAY': 1, 'HTTPCACHE_ENABLED': True, 'LOG_FILE': './log.log', 'NEWSPIDER_MODULE': 'lianjia.spiders', 'SPIDER_MODULES': ['lianjia.spiders'], 'TELNETCONSOLE_ENABLED': False}
2020-03-20 21:37:18 [scrapy.middleware] INFO: Enabled extensions:
['scrapy.extensions.corestats.CoreStats', 'scrapy.extensions.logstats.LogStats']
2020-03-20 21:37:18 [scrapy.middleware] INFO: Enabled downloader middlewares:
['scrapy.downloadermiddlewares.httpauth.HttpAuthMiddleware',
 'scrapy.downloadermiddlewares.downloadtimeout.DownloadTimeoutMiddleware',
 'scrapy.downloadermiddlewares.defaultheaders.DefaultHeadersMiddleware',
 'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware',
 'scrapy.downloadermiddlewares.retry.RetryMiddleware',
 'scrapy.downloadermiddlewares.redirect.MetaRefreshMiddleware',
 'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware',
 'scrapy.downloadermiddlewares.redirect.RedirectMiddleware',
 'scrapy.downloadermiddlewares.httpproxy.HttpProxyMiddleware',
 'scrapy.downloadermiddlewares.stats.DownloaderStats',
 'scrapy.downloadermiddlewares.httpcache.HttpCacheMiddleware']
2020-03-20 21:37:18 [scrapy.middleware] INFO: Enabled spider middlewares:
['scrapy.spidermiddlewares.httperror.HttpErrorMiddleware',
 'scrapy.spidermiddlewares.offsite.OffsiteMiddleware',
 'scrapy.spidermiddlewares.referer.RefererMiddleware',
 'scrapy.spidermiddlewares.urllength.UrlLengthMiddleware',
 'scrapy.spidermiddlewares.depth.DepthMiddleware']
2020-03-20 21:37:18 [matplotlib] DEBUG: CACHEDIR=C:\Users\Allen\.matplotlib
2020-03-20 21:37:18 [matplotlib.font_manager] DEBUG: Using fontManager instance from C:\Users\Allen\.matplotlib\fontlist-v310.json
2020-03-20 21:37:18 [scrapy.middleware] INFO: Enabled item pipelines:
['lianjia.pipelines.LianjiaPipeline']
2020-03-20 21:37:18 [scrapy.core.engine] INFO: Spider opened
2020-03-20 21:37:18 [scrapy.extensions.logstats] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2020-03-20 21:37:18 [scrapy.extensions.httpcache] DEBUG: Using filesystem cache storage in C:\Users\Allen\Desktop\test\lianjia\.scrapy\httpcache
2020-03-20 21:37:18 [scrapy.downloadermiddlewares.redirect] DEBUG: Redirecting (301) to <GET https://weihai.lianjia.com/ershoufang/pg/> from <GET https://weihai.lianjia.com/ershoufang/pg>
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg/> (referer: None) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg12/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg11/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg10/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg9/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg8/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg7/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg6/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg5/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg4/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg3/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg2/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg1/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg82/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg81/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg80/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg79/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg78/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg77/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg76/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg75/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg74/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg73/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg72/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg71/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg70/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg100/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg12/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg99/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg11/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg10/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg9/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg8/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg6/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg7/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg98/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg97/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg96/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg95/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg94/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg93/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg5/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg92/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg4/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg3/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg1/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg82/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg2/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg81/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg77/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg80/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg79/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg78/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg71/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg70/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg73/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg75/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg74/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg76/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg72/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg100/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg91/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg90/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg89/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg88/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg87/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg86/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg85/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg84/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg83/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg69/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg68/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg67/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg66/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg65/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg64/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg63/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg62/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg61/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg99/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg97/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg96/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg95/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg94/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg98/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg93/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg92/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg60/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg59/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg58/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg57/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg56/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg55/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg54/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg53/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg91/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg87/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg86/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg90/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg89/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg88/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg85/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg52/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg51/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg50/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg49/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg48/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg47/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg46/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg84/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg83/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg69/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg68/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg67/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg45/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg44/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg43/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg42/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg41/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg66/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg61/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg63/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg64/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg65/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg62/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg60/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg59/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg58/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg57/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg56/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg55/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg54/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg53/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg40/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg39/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg38/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg37/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg36/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg35/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg34/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg33/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg32/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg31/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg30/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg29/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg28/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg27/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg52/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg46/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg48/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg50/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg49/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg51/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg47/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg45/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg44/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg43/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg41/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg42/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg26/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg25/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg24/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg23/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg22/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg21/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg20/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg19/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg18/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg17/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg16/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg15/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg40/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg39/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg32/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg36/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg34/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg33/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg35/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg38/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg37/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg28/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg27/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg31/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg30/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg29/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg14/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg13/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg26/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg25/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg24/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg19/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg21/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg20/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg23/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg22/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg18/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg15/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg16/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg17/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg13/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg14/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 33, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:20 [scrapy.core.engine] INFO: Closing spider (finished)
2020-03-20 21:37:20 [scrapy.statscollectors] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 35583,
 'downloader/request_count': 102,
 'downloader/request_method_count/GET': 102,
 'downloader/response_bytes': 3165205,
 'downloader/response_count': 102,
 'downloader/response_status_count/200': 101,
 'downloader/response_status_count/301': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2020, 3, 20, 13, 37, 20, 52729),
 'httpcache/hit': 102,
 'log_count/DEBUG': 105,
 'log_count/ERROR': 100,
 'log_count/INFO': 7,
 'request_depth_max': 1,
 'response_received_count': 101,
 'scheduler/dequeued': 102,
 'scheduler/dequeued/memory': 102,
 'scheduler/enqueued': 102,
 'scheduler/enqueued/memory': 102,
 'spider_exceptions/TypeError': 100,
 'start_time': datetime.datetime(2020, 3, 20, 13, 37, 18, 804007)}
2020-03-20 21:37:20 [scrapy.core.engine] INFO: Spider closed (finished)
2020-03-20 21:37:45 [scrapy.utils.log] INFO: Scrapy 1.6.0 started (bot: lianjia)
2020-03-20 21:37:45 [scrapy.utils.log] INFO: Versions: lxml 3.7.3.0, libxml2 2.9.4, cssselect 1.0.3, parsel 1.5.1, w3lib 1.20.0, Twisted 19.2.1, Python 3.6.7 (v3.6.7:6ec5cf24b7, Oct 20 2018, 13:35:33) [MSC v.1900 64 bit (AMD64)], pyOpenSSL 18.0.0 (OpenSSL 1.1.1d  10 Sep 2019), cryptography 2.8, Platform Windows-10-10.0.18362-SP0
2020-03-20 21:37:45 [scrapy.crawler] INFO: Overridden settings: {'BOT_NAME': 'lianjia', 'CONCURRENT_ITEMS': 32, 'CONCURRENT_REQUESTS': 32, 'COOKIES_ENABLED': False, 'DOWNLOAD_DELAY': 1, 'HTTPCACHE_ENABLED': True, 'LOG_FILE': './log.log', 'NEWSPIDER_MODULE': 'lianjia.spiders', 'SPIDER_MODULES': ['lianjia.spiders'], 'TELNETCONSOLE_ENABLED': False}
2020-03-20 21:37:45 [scrapy.middleware] INFO: Enabled extensions:
['scrapy.extensions.corestats.CoreStats', 'scrapy.extensions.logstats.LogStats']
2020-03-20 21:37:45 [scrapy.middleware] INFO: Enabled downloader middlewares:
['scrapy.downloadermiddlewares.httpauth.HttpAuthMiddleware',
 'scrapy.downloadermiddlewares.downloadtimeout.DownloadTimeoutMiddleware',
 'scrapy.downloadermiddlewares.defaultheaders.DefaultHeadersMiddleware',
 'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware',
 'scrapy.downloadermiddlewares.retry.RetryMiddleware',
 'scrapy.downloadermiddlewares.redirect.MetaRefreshMiddleware',
 'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware',
 'scrapy.downloadermiddlewares.redirect.RedirectMiddleware',
 'scrapy.downloadermiddlewares.httpproxy.HttpProxyMiddleware',
 'scrapy.downloadermiddlewares.stats.DownloaderStats',
 'scrapy.downloadermiddlewares.httpcache.HttpCacheMiddleware']
2020-03-20 21:37:45 [scrapy.middleware] INFO: Enabled spider middlewares:
['scrapy.spidermiddlewares.httperror.HttpErrorMiddleware',
 'scrapy.spidermiddlewares.offsite.OffsiteMiddleware',
 'scrapy.spidermiddlewares.referer.RefererMiddleware',
 'scrapy.spidermiddlewares.urllength.UrlLengthMiddleware',
 'scrapy.spidermiddlewares.depth.DepthMiddleware']
2020-03-20 21:37:45 [matplotlib] DEBUG: CACHEDIR=C:\Users\Allen\.matplotlib
2020-03-20 21:37:45 [matplotlib.font_manager] DEBUG: Using fontManager instance from C:\Users\Allen\.matplotlib\fontlist-v310.json
2020-03-20 21:37:45 [scrapy.middleware] INFO: Enabled item pipelines:
['lianjia.pipelines.LianjiaPipeline']
2020-03-20 21:37:45 [scrapy.core.engine] INFO: Spider opened
2020-03-20 21:37:45 [scrapy.extensions.logstats] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2020-03-20 21:37:45 [scrapy.extensions.httpcache] DEBUG: Using filesystem cache storage in C:\Users\Allen\Desktop\test\lianjia\.scrapy\httpcache
2020-03-20 21:37:45 [scrapy.downloadermiddlewares.redirect] DEBUG: Redirecting (301) to <GET https://weihai.lianjia.com/ershoufang/pg/> from <GET https://weihai.lianjia.com/ershoufang/pg>
2020-03-20 21:37:45 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg/> (referer: None) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg1/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg75/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg74/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg73/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg72/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg71/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg70/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg69/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg68/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg67/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg66/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg65/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg64/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg63/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg62/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg61/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg60/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg59/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg58/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg57/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg56/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg55/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg54/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg53/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg52/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg100/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg1/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg99/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg75/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg98/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg74/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg73/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg72/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg71/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg97/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg96/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg95/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg94/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg70/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg69/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg93/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg92/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg68/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg67/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg66/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg64/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg63/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg65/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg58/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg56/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg57/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg62/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg60/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg59/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg61/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg52/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg54/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg53/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg55/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg91/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg90/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg89/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg88/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg87/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg86/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg85/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg84/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg83/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg82/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg81/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg80/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg79/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg78/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg77/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg76/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg100/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg51/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg50/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg99/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg98/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg97/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg95/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg94/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg93/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg92/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg96/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg49/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg48/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg47/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg46/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg45/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg44/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg43/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg42/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg91/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg86/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg90/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg89/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg88/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg87/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg82/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg81/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg85/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg84/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg83/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg41/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg40/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg39/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg38/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg37/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg36/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg35/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg34/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg33/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg32/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg31/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg80/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg79/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg78/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg77/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg76/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg30/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg29/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg28/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg27/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg26/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg51/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg50/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg49/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg48/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg47/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg46/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg45/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg44/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg25/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg24/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg23/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg22/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg21/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg20/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg19/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg18/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg42/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg43/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg41/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg17/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg16/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg15/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg39/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg40/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg35/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg34/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg37/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg36/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg38/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg31/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg33/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg32/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg14/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg13/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg12/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg11/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg10/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg9/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg8/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg7/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg6/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg5/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg30/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg29/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg28/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg27/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg26/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg4/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:47 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg3/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:47 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg2/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg23/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg22/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg25/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg24/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg21/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg19/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg20/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg18/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg17/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg16/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg15/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg14/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg12/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg13/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg8/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg10/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg9/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg11/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg7/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg6/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg5/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg4/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg3/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg2/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:37:47 [scrapy.core.engine] INFO: Closing spider (finished)
2020-03-20 21:37:47 [scrapy.statscollectors] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 35583,
 'downloader/request_count': 102,
 'downloader/request_method_count/GET': 102,
 'downloader/response_bytes': 3165205,
 'downloader/response_count': 102,
 'downloader/response_status_count/200': 101,
 'downloader/response_status_count/301': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2020, 3, 20, 13, 37, 47, 232501),
 'httpcache/hit': 102,
 'log_count/DEBUG': 105,
 'log_count/ERROR': 100,
 'log_count/INFO': 7,
 'request_depth_max': 1,
 'response_received_count': 101,
 'scheduler/dequeued': 102,
 'scheduler/dequeued/memory': 102,
 'scheduler/enqueued': 102,
 'scheduler/enqueued/memory': 102,
 'spider_exceptions/TypeError': 100,
 'start_time': datetime.datetime(2020, 3, 20, 13, 37, 45, 963918)}
2020-03-20 21:37:47 [scrapy.core.engine] INFO: Spider closed (finished)
2020-03-20 21:38:17 [scrapy.utils.log] INFO: Scrapy 1.6.0 started (bot: lianjia)
2020-03-20 21:38:17 [scrapy.utils.log] INFO: Versions: lxml 3.7.3.0, libxml2 2.9.4, cssselect 1.0.3, parsel 1.5.1, w3lib 1.20.0, Twisted 19.2.1, Python 3.6.7 (v3.6.7:6ec5cf24b7, Oct 20 2018, 13:35:33) [MSC v.1900 64 bit (AMD64)], pyOpenSSL 18.0.0 (OpenSSL 1.1.1d  10 Sep 2019), cryptography 2.8, Platform Windows-10-10.0.18362-SP0
2020-03-20 21:38:17 [scrapy.crawler] INFO: Overridden settings: {'BOT_NAME': 'lianjia', 'CONCURRENT_ITEMS': 32, 'CONCURRENT_REQUESTS': 32, 'COOKIES_ENABLED': False, 'DOWNLOAD_DELAY': 1, 'HTTPCACHE_ENABLED': True, 'LOG_FILE': './log.log', 'NEWSPIDER_MODULE': 'lianjia.spiders', 'SPIDER_MODULES': ['lianjia.spiders'], 'TELNETCONSOLE_ENABLED': False}
2020-03-20 21:38:17 [scrapy.middleware] INFO: Enabled extensions:
['scrapy.extensions.corestats.CoreStats', 'scrapy.extensions.logstats.LogStats']
2020-03-20 21:38:18 [scrapy.middleware] INFO: Enabled downloader middlewares:
['scrapy.downloadermiddlewares.httpauth.HttpAuthMiddleware',
 'scrapy.downloadermiddlewares.downloadtimeout.DownloadTimeoutMiddleware',
 'scrapy.downloadermiddlewares.defaultheaders.DefaultHeadersMiddleware',
 'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware',
 'scrapy.downloadermiddlewares.retry.RetryMiddleware',
 'scrapy.downloadermiddlewares.redirect.MetaRefreshMiddleware',
 'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware',
 'scrapy.downloadermiddlewares.redirect.RedirectMiddleware',
 'scrapy.downloadermiddlewares.httpproxy.HttpProxyMiddleware',
 'scrapy.downloadermiddlewares.stats.DownloaderStats',
 'scrapy.downloadermiddlewares.httpcache.HttpCacheMiddleware']
2020-03-20 21:38:18 [scrapy.middleware] INFO: Enabled spider middlewares:
['scrapy.spidermiddlewares.httperror.HttpErrorMiddleware',
 'scrapy.spidermiddlewares.offsite.OffsiteMiddleware',
 'scrapy.spidermiddlewares.referer.RefererMiddleware',
 'scrapy.spidermiddlewares.urllength.UrlLengthMiddleware',
 'scrapy.spidermiddlewares.depth.DepthMiddleware']
2020-03-20 21:38:18 [matplotlib] DEBUG: CACHEDIR=C:\Users\Allen\.matplotlib
2020-03-20 21:38:18 [matplotlib.font_manager] DEBUG: Using fontManager instance from C:\Users\Allen\.matplotlib\fontlist-v310.json
2020-03-20 21:38:18 [scrapy.middleware] INFO: Enabled item pipelines:
['lianjia.pipelines.LianjiaPipeline']
2020-03-20 21:38:18 [scrapy.core.engine] INFO: Spider opened
2020-03-20 21:38:18 [scrapy.extensions.logstats] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2020-03-20 21:38:18 [scrapy.extensions.httpcache] DEBUG: Using filesystem cache storage in C:\Users\Allen\Desktop\test\lianjia\.scrapy\httpcache
2020-03-20 21:38:18 [scrapy.downloadermiddlewares.redirect] DEBUG: Redirecting (301) to <GET https://weihai.lianjia.com/ershoufang/pg/> from <GET https://weihai.lianjia.com/ershoufang/pg>
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg/> (referer: None) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg23/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg22/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg21/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg20/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg19/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg18/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg17/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg16/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg15/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg14/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg13/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg12/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg11/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg10/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg9/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg8/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg7/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg6/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg5/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg4/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg3/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg2/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg1/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg100/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg99/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg98/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg23/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg22/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg21/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg20/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg19/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg18/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg97/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg96/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg95/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg94/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg93/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg92/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg17/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg16/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg15/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg91/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg90/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg89/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg13/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg14/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg12/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg11/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg10/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg9/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg7/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg5/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg6/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg8/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg4/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg99/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg98/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg3/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg1/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg100/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg2/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg88/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg87/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg86/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg85/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg84/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg83/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg82/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg81/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg80/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg79/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg78/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg77/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg76/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg75/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg74/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg73/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg72/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg97/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg94/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg93/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg92/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg91/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg96/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg95/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg90/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg89/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg71/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg70/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg69/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg68/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg67/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg66/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg65/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg64/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg63/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg86/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg87/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg88/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg83/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg85/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg84/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg82/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg62/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg61/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg60/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg59/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg58/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg57/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg56/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg81/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg80/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg79/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg77/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg75/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg76/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg78/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg74/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg73/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg72/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg55/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg54/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg53/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg52/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg51/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg50/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg49/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg48/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg47/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg46/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg71/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg70/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg69/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg68/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg66/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg65/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg63/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg64/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg67/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg45/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg44/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg43/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg42/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg41/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg40/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg39/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg38/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg37/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg62/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg61/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg56/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg57/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg60/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg59/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg58/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg55/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg54/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg53/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg36/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg35/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg34/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg33/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg32/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg31/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg30/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg29/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg28/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg27/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg52/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg51/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg50/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg49/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg48/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg47/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg26/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg25/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg24/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg46/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg45/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg44/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg39/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg37/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg38/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg43/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg41/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg40/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg42/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg36/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg35/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg34/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg32/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg33/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg27/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg29/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg30/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg31/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg28/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg26/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg25/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg24/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:19 [scrapy.core.engine] INFO: Closing spider (finished)
2020-03-20 21:38:19 [scrapy.statscollectors] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 35583,
 'downloader/request_count': 102,
 'downloader/request_method_count/GET': 102,
 'downloader/response_bytes': 3165205,
 'downloader/response_count': 102,
 'downloader/response_status_count/200': 101,
 'downloader/response_status_count/301': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2020, 3, 20, 13, 38, 19, 755897),
 'httpcache/hit': 102,
 'log_count/DEBUG': 105,
 'log_count/ERROR': 100,
 'log_count/INFO': 7,
 'request_depth_max': 1,
 'response_received_count': 101,
 'scheduler/dequeued': 102,
 'scheduler/dequeued/memory': 102,
 'scheduler/enqueued': 102,
 'scheduler/enqueued/memory': 102,
 'spider_exceptions/TypeError': 100,
 'start_time': datetime.datetime(2020, 3, 20, 13, 38, 18, 486886)}
2020-03-20 21:38:19 [scrapy.core.engine] INFO: Spider closed (finished)
2020-03-20 21:38:38 [scrapy.utils.log] INFO: Scrapy 1.6.0 started (bot: lianjia)
2020-03-20 21:38:38 [scrapy.utils.log] INFO: Versions: lxml 3.7.3.0, libxml2 2.9.4, cssselect 1.0.3, parsel 1.5.1, w3lib 1.20.0, Twisted 19.2.1, Python 3.6.7 (v3.6.7:6ec5cf24b7, Oct 20 2018, 13:35:33) [MSC v.1900 64 bit (AMD64)], pyOpenSSL 18.0.0 (OpenSSL 1.1.1d  10 Sep 2019), cryptography 2.8, Platform Windows-10-10.0.18362-SP0
2020-03-20 21:38:38 [scrapy.crawler] INFO: Overridden settings: {'BOT_NAME': 'lianjia', 'CONCURRENT_ITEMS': 32, 'CONCURRENT_REQUESTS': 32, 'COOKIES_ENABLED': False, 'DOWNLOAD_DELAY': 1, 'HTTPCACHE_ENABLED': True, 'LOG_FILE': './log.log', 'NEWSPIDER_MODULE': 'lianjia.spiders', 'SPIDER_MODULES': ['lianjia.spiders'], 'TELNETCONSOLE_ENABLED': False}
2020-03-20 21:38:38 [scrapy.middleware] INFO: Enabled extensions:
['scrapy.extensions.corestats.CoreStats', 'scrapy.extensions.logstats.LogStats']
2020-03-20 21:38:38 [scrapy.middleware] INFO: Enabled downloader middlewares:
['scrapy.downloadermiddlewares.httpauth.HttpAuthMiddleware',
 'scrapy.downloadermiddlewares.downloadtimeout.DownloadTimeoutMiddleware',
 'scrapy.downloadermiddlewares.defaultheaders.DefaultHeadersMiddleware',
 'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware',
 'scrapy.downloadermiddlewares.retry.RetryMiddleware',
 'scrapy.downloadermiddlewares.redirect.MetaRefreshMiddleware',
 'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware',
 'scrapy.downloadermiddlewares.redirect.RedirectMiddleware',
 'scrapy.downloadermiddlewares.httpproxy.HttpProxyMiddleware',
 'scrapy.downloadermiddlewares.stats.DownloaderStats',
 'scrapy.downloadermiddlewares.httpcache.HttpCacheMiddleware']
2020-03-20 21:38:38 [scrapy.middleware] INFO: Enabled spider middlewares:
['scrapy.spidermiddlewares.httperror.HttpErrorMiddleware',
 'scrapy.spidermiddlewares.offsite.OffsiteMiddleware',
 'scrapy.spidermiddlewares.referer.RefererMiddleware',
 'scrapy.spidermiddlewares.urllength.UrlLengthMiddleware',
 'scrapy.spidermiddlewares.depth.DepthMiddleware']
2020-03-20 21:38:38 [matplotlib] DEBUG: CACHEDIR=C:\Users\Allen\.matplotlib
2020-03-20 21:38:38 [matplotlib.font_manager] DEBUG: Using fontManager instance from C:\Users\Allen\.matplotlib\fontlist-v310.json
2020-03-20 21:38:38 [scrapy.middleware] INFO: Enabled item pipelines:
['lianjia.pipelines.LianjiaPipeline']
2020-03-20 21:38:38 [scrapy.core.engine] INFO: Spider opened
2020-03-20 21:38:38 [scrapy.extensions.logstats] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2020-03-20 21:38:38 [scrapy.extensions.httpcache] DEBUG: Using filesystem cache storage in C:\Users\Allen\Desktop\test\lianjia\.scrapy\httpcache
2020-03-20 21:38:38 [scrapy.downloadermiddlewares.redirect] DEBUG: Redirecting (301) to <GET https://weihai.lianjia.com/ershoufang/pg/> from <GET https://weihai.lianjia.com/ershoufang/pg>
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg/> (referer: None) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg14/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg13/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg12/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg11/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg10/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg9/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg8/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg7/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg6/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg5/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg4/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg3/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg2/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg1/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg90/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg89/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg88/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg87/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg86/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg85/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg84/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg83/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg82/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg81/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg80/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg100/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg14/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg99/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg13/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg12/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg9/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg11/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg10/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg98/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg97/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg96/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg95/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg94/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg8/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg93/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg7/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg5/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg3/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg4/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg6/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg2/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg87/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg86/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg1/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg89/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg88/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg90/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg81/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg83/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg82/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg85/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg84/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg80/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg100/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg92/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg91/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg79/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg78/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg77/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg76/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg75/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg74/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg73/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg72/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg71/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg70/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg69/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg68/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg67/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg66/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg65/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg64/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg63/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg99/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg97/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg96/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg98/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg93/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg95/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg94/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg62/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg61/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg60/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg59/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg58/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg57/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg56/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg92/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg91/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg78/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg79/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg77/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg55/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg54/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg53/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg52/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg76/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg75/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg74/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg72/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg73/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg71/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg70/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg69/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg64/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg66/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg68/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg67/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg65/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg63/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg51/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg50/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg49/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg48/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg47/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg46/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg45/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg44/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg43/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg42/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg41/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg40/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg39/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg38/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg37/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg62/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg58/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg61/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg60/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg59/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg56/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg57/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg36/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg35/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg34/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg33/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg53/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg52/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg55/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg54/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg32/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg31/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg30/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg29/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg28/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg27/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg26/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg51/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg50/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg49/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg48/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg47/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg46/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg41/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg40/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg39/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg45/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg43/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg42/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg44/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg37/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg38/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg25/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg24/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg23/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg22/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg21/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg20/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg19/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg18/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg17/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg16/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://weihai.lianjia.com/ershoufang/pg15/> (referer: https://weihai.lianjia.com/ershoufang/pg/) ['cached']
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg36/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg35/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg31/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg34/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg33/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg32/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg27/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg26/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg29/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg28/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg30/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg25/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg23/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg22/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg24/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg21/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg17/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg19/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg18/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg20/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg15/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://weihai.lianjia.com/ershoufang/pg16/> (referer: https://weihai.lianjia.com/ershoufang/pg/)
Traceback (most recent call last):
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\utils\defer.py", line 102, in iter_errback
    yield next(it)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\offsite.py", line 29, in process_spider_output
    for x in result:
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\spidermiddlewares\depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "C:\Users\Allen\Desktop\test\lianjia\lianjia\spiders\lianjia.py", line 32, in get_link
    yield Request(link,self.get_data)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 25, in __init__
    self._set_url(url)
  File "C:\Users\Allen\AppData\Local\Programs\Python\Python36\lib\site-packages\scrapy\http\request\__init__.py", line 56, in _set_url
    raise TypeError('Request url must be str or unicode, got %s:' % type(url).__name__)
TypeError: Request url must be str or unicode, got Selector:
2020-03-20 21:38:39 [scrapy.core.engine] INFO: Closing spider (finished)
2020-03-20 21:38:39 [scrapy.statscollectors] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 35583,
 'downloader/request_count': 102,
 'downloader/request_method_count/GET': 102,
 'downloader/response_bytes': 3165205,
 'downloader/response_count': 102,
 'downloader/response_status_count/200': 101,
 'downloader/response_status_count/301': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2020, 3, 20, 13, 38, 39, 897275),
 'httpcache/hit': 102,
 'log_count/DEBUG': 105,
 'log_count/ERROR': 100,
 'log_count/INFO': 7,
 'request_depth_max': 1,
 'response_received_count': 101,
 'scheduler/dequeued': 102,
 'scheduler/dequeued/memory': 102,
 'scheduler/enqueued': 102,
 'scheduler/enqueued/memory': 102,
 'spider_exceptions/TypeError': 100,
 'start_time': datetime.datetime(2020, 3, 20, 13, 38, 38, 567739)}
2020-03-20 21:38:39 [scrapy.core.engine] INFO: Spider closed (finished)
